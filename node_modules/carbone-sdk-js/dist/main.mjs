var D=Object.defineProperty,E=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var b=(c,r,a)=>r in c?D(c,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[r]=a,f=(c,r)=>{for(var a in r||(r={}))A.call(r,a)&&b(c,a,r[a]);if(g)for(var a of g(r))C.call(r,a)&&b(c,a,r[a]);return c},m=(c,r)=>E(c,S(r));var p=function(c){let r={apiUrl:"https://api.carbone.io",accessToken:c,apiVersion:4,apiHeaders:{}},a=function(e,n,t){return fetch("".concat(r.apiUrl).concat(n),m(f({method:e},t!=null&&t.body?{body:t.body}:{}),{headers:f(f({"carbone-version":r.apiVersion,Authorization:"Bearer "+r.accessToken},t!=null&&t.headers?t.headers:{}),r!=null&&r.apiHeaders?r.apiHeaders:{})}))};return{setApiHeaders:function(e){e&&typeof e=="object"&&(r.apiHeaders=e)},getApiHeaders:function(){return r.apiHeaders},getAccessToken:function(){return r.accessToken},setAccessToken:function(e){r.accessToken=e},getApiVersion:function(){return r.apiVersion},setApiVersion:function(e){r.apiVersion=e},getApiUrl:function(){return r.apiUrl},setApiUrl:function(e){r.apiUrl=e},addTemplate:async function(e,n=""){var t=new FormData;if(!e)throw new Error("Carbone SDK addTemplate error: the file argument is not valid.");return t.append("payload",n),t.append("template",e),await(await a("post","/template",{body:t})).json()},deleteTemplate:async function(e){if(!e)throw new Error("Carbone SDK deleteTemplate error: the templateId argument is not valid.");return await(await a("delete","/template/".concat(e))).json()},getTemplate:async function(e,n="blob"){if(!e)throw new Error("Carbone SDK getTemplate error: the templateId argument is not valid.");if(["blob","text"].indexOf(n)===-1)throw new Error("Carbone SDK getTemplate error: the responseType argument is not valid.");return await(await a("get","/template/".concat(e)))[n]()},renderReport:async function(e,n){if(!e)throw new Error("Carbone SDK renderReport error: the templateId argument is not valid.");if(!n)throw new Error("Carbone SDK renderReport error: the data argument is not valid.");return await(await a("post","/render/".concat(e),{body:JSON.stringify(n),headers:{"Content-type":"application/json"}})).json()},getReport:async function(e,n="blob"){if(!e)throw new Error("Carbone SDK getReport error: the renderId argument is not valid.");if(["blob","text"].indexOf(n)===-1)throw new Error("Carbone SDK getReport error: the responseType argument is not valid.");let t=await a("get","/render/".concat(e));return{content:await t[n](),name:this.getReportNameFromHeader(t.headers)}},render:async function(e,n,t="",s="blob"){if(!e)throw new Error("Carbone SDK render error: the templateId argument is not valid.");if(!n)throw new Error("Carbone SDK render error: the data argument is not valid.");let o=null;if(typeof e=="string"&&e.length===64&&Object.prototype.hasOwnProperty.call(e,"name")===!1)o=await this.renderReport(e,n);else{let d=await(typeof e=="string"?e:await e.arrayBuffer().then(i=>new Uint8Array(i))),u=await this.generateTemplateId(d,t);if(u&&(o=await this.renderReport(u,n)),o===null||o.success===!1){let i=await this.addTemplate(e,t);if((i==null?void 0:i.success)===!0&&i.data.templateId)o=await this.renderReport(i.data.templateId,n);else throw new Error("Carbone Upload Template To Generate Document Error: "+(i==null?void 0:i.error))}}if(!o||o.success===!1||!o.data.renderId)throw new Error("Carbone Generate Document Error: "+(o==null?void 0:o.error));return this.getReport(o.data.renderId,s)},generateTemplateId:async function(e,n=""){function t(u){for(var i="",w=new DataView(u),l=0;l<w.byteLength;l+=4){var y=w.getUint32(l),v=y.toString(16),h="00000000",T=(h+v).slice(-h.length);i+=T}return i}var s=typeof e=="string"?new TextEncoder("utf-8").encode(e):e,o=typeof n=="string"?new TextEncoder("utf-8").encode(n):n,d=new Uint8Array(o.length+s.length);return d.set(o),d.set(s,o.length),await crypto.subtle.digest("SHA-256",d).then(function(u){return t(u)})},getReportNameFromHeader(e){if(!e)return null;let n=e.get("content-disposition");if(!n)return null;let t=n.split("=");if(t.length===1||!t[1])return null;let s=t[1];return s[0]==='"'&&s[s.length-1]==='"'&&(s=s.substr(1,t[1].length-2)),s}}};typeof window<"u"&&(window.carboneRenderSDK=p,window.carboneSDK=p);var H=p;export{H as default};
//# sourceMappingURL=main.mjs.map
